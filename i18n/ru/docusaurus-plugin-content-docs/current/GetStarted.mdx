---
id: get-started
title: Как начать
description: Getting started with Casbin
keywords:
  - Casbin
  - get started
  - installation
  - usage
authors:
  - nodece
---



## Установка

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```
go get github.com/casbin/casbin/v2
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

Maven:

```xml
<!-- https://mvnrepository.com/artifact/org.casbin/jcasbin -->
<dependency>
    <groupId>org.casbin</groupId>
    <artifactId>jcasbin</artifactId>
    <version>1.x.y</version>
</dependency>
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```bash
# NPM
npm install casbin --save

# Yarn
yarn add casbin
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

PHP. Установите пакет с помощью composer. Команда для установки пакета:

```bash
composer require casbin/casbin
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```bash
pip install casbin
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```


```bash
dotnet add package Casbin.NET
```

```mdx-code-block
</TabItem>
<TabItem value="C++" label="C++">
```

```bash
# скачать исходный код
git clone https://github.com/casbin/casbin-cpp. он

# генерировать файлы проектов
cd casbin-cpp && mkdir build && cd build && cmake .. -DCMAKE_BUILD_TYPE=Release

# build and install casbin
cmake --build . --config Release --target casbin install -j 10
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```bash
cargo install cargo-edit
add casbin

// Если вы используете async-std как async executor
cargo add async-std

// Если вы используете tokio as async executor
cargo add tokio // убедитесь, что вы активировали его функцию `macros`
```

```mdx-code-block
</TabItem>
<TabItem value="Delphi" label="Delphi">
```

Delphi: Casbin4D поставляется в пакете (сейчас для Delphi 10.3 Rio) и вы можете установить его в IDE. Тем не менее, там нет визуальных компонентов, а значит вы не сможете  использовать модули независимо от пакетов. Просто импортируйте модули в свой проект (при условии, что вам не важно их количество)

```mdx-code-block
</TabItem>
<TabItem value="Lua" label="Lua">
```

```bash
luarocks установить casbin  
```

Если сообщение ошибка: Ваш пользователь не имеет разрешения на запись в /usr/local/lib/luarocks/rocks -- вы можете запустить как привилегированный пользователь или использовать ваше локальное дерево с --local. вы можете добавить --local за вашей командой, чтобы исправить:

```bash
luarocks установить casbin --local
```

```mdx-code-block
</TabItem>
</Tabs>
```

## Новый силуэт Касбина

Касбин использует конфигурационные файлы для установки модели контроля доступа.

Он имеет два файла конфигурации: `model.conf` и `policy.csv`. Среди них `model.conf` хранит нашу модель доступа, а `policy.csv` хранит конфигурацию разрешения для конкретного пользователя. Использование Касбина очень изысканно. В основном, нам нужна одна главная структура: **энсил**. При построении этой структуры будут загружены `model.conf` и `policy.csv`.

Другим словом является новый фортепиатель Касбина, вы должны предоставить [модель](supported-models) и [адаптер](adapters).

Casbin has a [FileAdapter](adapters#file-adapter-built-in), see [Adapter](adapters) for more information.

- Используйте файл модели и по умолчанию [FileAdapter](adapters#file-adapter-built-in):

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
import "github.com/casbin/casbin/v2"

e, err := casbin.NewEnforcer("path/to/model.conf", "path/to/policy.csv")
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
import org.casbin.jcasbin.main.Enforcer;

Enforcer e = new Enforcer("path/to/model.conf", "path/to/policy.csv");
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```javascript
import { newEnforcer } from 'casbin';

const e = await newEnforcer('path/to/model.conf', 'path/to/policy.csv');
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
require_once './vendor/autoload.php';

use Casbin\Enforcer;

$e = new Enforcer("path/to/model.conf", "path/to/policy.csv");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
import casbin

e = casbin.Enforcer("path/to/model.conf", "path/to/policy.csv")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
using NetCasbin; 

var e = new Enforcer("path/to/model.conf", "path/to/policy.csv");
```

```mdx-code-block
</TabItem>
<TabItem value="C++" label="C++">
```

```cpp
#include <iostream>
#include <casbin/casbin.h>

int main() {
    // Create an Enforcer
    casbin::Enforcer e("path/to/model.conf", "path/to/policy.csv");

    // ваш код ..
}
```

```mdx-code-block
</TabItem>
<TabItem value="Delphi" label="Delphi">
```

```delphi
var
  casbin: ICasbin;
begin
  casbin := TCasbin.Create('path/to/model.conf', 'path/to/policy.csv');
  ...
end
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
использование казино::prelude::*;

// Если вы используете async_td как исполнитель async
#[cfg(feature = "runtime-async-std")]
#[async_std::main]
async fn main() -> Result<()> {
    let mut e = Enforcer::new("path/to/model. onf", "path/to/policy.csv"). Ождите?;
    Ok())
}

// Если вы используете tokio as async исполнитель
#[cfg(feature = "runtime-tokio")]
#[tokio:main]
async fn main() -> Result<()> {
    let mut e = Enforcer::new("path/to/model. onf", "path/to/policy.csv").await?;
    Ok())
}
```

```mdx-code-block
</TabItem>
<TabItem value="Lua" label="Lua">
```

```lua
локальный Силор = require("casbin")
local e = Enforcer:new("path/to/model.conf", "path/to/policy.csv") -- Силовик Касбин
```

```mdx-code-block
</TabItem>
</Tabs>
```

- Используйте текст модели с другим адаптером:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
import (
    "log"

    "github.com/casbin/casbin/v2"
    "github.com/casbin/casbin/v2/model"
    xormadapter "github.com/casbin/xorm-adapter/v2"
    _ "github.com/go-sql-driver/mysql"
)

// Инициализация Xorm адаптера с базой данных MySQL.
a, err := xormadapter.NewAdapter("mysql", "mysql_username:mysql_password@tcp(127.0.0. :3306)/casbin")
if err != nil {
    log.Fatalf("error: adapter: %s", err)
}

m, err := model. ewModelFromString(`
[request_definition]
r = sub, obj, act

[policy_definition]
p = sub, obj, act

[policy_effect]
e = some(where (p. ft == allow))

[matchers]
м = r.sub == p.sub && r.obj == p. bj && r.act == p.act
`)
if err != nil {
    log. atalf("error: model: %s", err)
}

e, err := casbin. ewEnforcer(m, a)
if err != nil {
    log.Fatalf("ошибка: enforcer: %s", err)
}
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
import casbin
import casbin_sqlalchemy_adapter


# Используйте адаптер SQLAlchemy Casbin с SQLLite DB
адаптер = casbin_sqlalchemy_adapter. dapter('sqlite:///test.db')

# Создать политику модели конфигурации
с open("rbac_example_model.conf", "w") как f:
    f. rite("""
    [request_definition]
    r = sub, obj, акт

    [policy_definition]
    p = sub, obj, действовать

    [policy_effect]
    e = где-то (стр. f== допустить))

    [matchers]
    м = r. ub == p.sub && r.obj == p.obj && r.act == p. ct
    """)

# Создайте энсилятор из адаптера и политики конфигурации
e = casbin.Enforcer('rbac_example_model.conf', адаптер)
```

```mdx-code-block
</TabItem>
</Tabs>
```

### Проверить права доступа

Добавьте вызов энфорсера в свой код там, где необходимо контролировать доступ:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
sub := "alice" // пользователь, который хочет получить доступ к ресурсу.
obj := "data1" // ресурс, доступ к которому запрашивается.
act := "read" // действие, которое совершает пользователь над ресурсом.

ok, err := e. nforce(sub, obj, act)

если err ! nil {
    // обработка err
}

if ok == true {
    // разрешить alice к чтению данных 1
} else {
    // отрицаем запрос, показать ошибку
}

// Вы можете использовать BatchEnforce() для применения некоторых запросов в пакетах.
// Этот метод возвращает маску буля, и этот индекс ломтика соответствует индексу строк двухмерного массива.
// например, результаты[0] — это результат {"alice", "data1", "read"}
results, err := e.BatchEnforce([][][]interface{}{"alice", "data1", "read"}, {"bob", "data2", "write"}, {"jack", "data3", "read"}})
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
String sub = "alice"; // пользователь, который хочет получить доступ к ресурсу.
String obj = "data1"; // ресурс, доступ к которому запрашивается.
String act = "read"; // действие, которое совершает пользователь над ресурсом.

if (e. nforce(sub, obj, act) == true) {
    // разрешить alice to read data1
} else {
    // Отказать в запросе, показать ошибку
}
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```js
const sub = 'alice'; // пользователь, который хочет получить доступ к ресурсу.
const obj = 'data1'; // ресурс, доступ к которому запрашивается.
const act = 'read'; // действие, которое совершает пользователь над ресурсом.

if (ждут e. nforce(sub, obj, act)) === true) {
    // разрешить alice to read data1
} else {
    // Отказать в запросе, показать ошибку
}
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$sub = "alice"; // пользователь, который хочет получить доступ к ресурсу.
$obj = "data1"; // ресурс, доступ к которому запрашивается.
$act = "read"; // действие, которое совершает пользователь над ресурсом.

if ($e->enforce($sub, $obj, $act) === true) {
    // разрешить alice1 читать (read) ресурс data1
} else {
    // запретить, показать ошибку
}
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
sub = "alice"  # пользователь, который хочет получить доступ к ресурсу.
obj = "data1"  # ресурс, доступ к которому запрашивается.
act = "read"  # действие, которое совершает пользователь над ресурсом.

if e.enforce(sub, obj, act):
    # разрешить alice1 читать (read) ресурс data1
    pass
else:
    # разрешить alice1 читать (read) ресурс data1
    pass
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var sub = "alice"; # пользователь, который хочет получить доступ к ресурсу.
# ресурс var obj = "data1".
var act = "read"; # операция, выполняемая пользователем на ресурсе.

if (ожидание e. nforceAsync(sub, obj, act)) 
{
    // разрешить alice to read data1
}
else
{
    // Отклонить запрос, показать ошибку
}
```

```mdx-code-block
</TabItem>
<TabItem value="C++" label="C++">
```

```cpp
    casbin::Enforcer e("../assets/model.conf", "../assets/policy.csv");

    if (e. nforce({"alice", "/alice_data/hello", "GET"})) {
        std::cout << "Enforce OK" << std::endl;
    } else {
        std::cout << "Enforce NOT Good" << std::endl;
    }

    if (e. nforce({"alice", "/alice_data/hello", "POST"})) {
        std::cout << "Enforce OK" << std::endl;
    } else {
        std::cout << "Enforce NOT Good" << std::endl;
}
```

```mdx-code-block
</TabItem>
<TabItem value="Delphi" label="Delphi">
```

```delphi
if casbin.enforce(['alice,data1,read']) then
  // Alice супер счастлива, потому что она может читать data1
else
  // Alice растроена
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
  let sub = "alice"; // пользователь, который хочет получить доступ к ресурсу.
  let obj = "data1"; // ресурс, к которому будет доступ.
  let act = "read"; // операция, выполняемая пользователем на ресурсе.

  if e.enforce(sub, obj, act)).await? {
      // разрешить alice to read data1
  } else {
      // ошибка
}
```

```mdx-code-block
</TabItem>
<TabItem value="Lua" label="Lua">
```

```lua
если e:enforce("alice", "data1", "read") затем
   -- разрешить alice to read data1
else
   -- отклонить запрос, показать ошибку
конца

```

```mdx-code-block
</TabItem>
</Tabs>
```

Касбин также предоставляет API для управления разрешениями во время выполнения. Например, вы можете получить все роли, назначенные пользователю как ниже:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
roles, err := e.GetRolesForUser("alice")
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
List<String> roles = e.getRolesForUser("alice");
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```javascript
const roles = await e.getRolesForUser('alice');
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$roles = $e->getRolesForUser("alice");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
roles = e.get_roles_for_user("alice")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var roles = e.GetRolesForUser("alice");
```

```mdx-code-block
</TabItem>
<TabItem value="Delphi" label="Delphi">
```

```delphi
roles = e.rolesForEntity("alice")
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let roles = e.get_roles_for_user("alice");
```

```mdx-code-block
</TabItem>
<TabItem value="Lua" label="Lua">
```

```lua
local roles = e:GetRolesForUser("alice")
```

```mdx-code-block
</TabItem>
</Tabs>
```

Смотрите [Management API](/docs/management-api) и [RBAC API](/docs/rbac-api) для большего использования.

Вы можете посмотреть на тест кейсы, чтобы увидеть больше примеров использования.
