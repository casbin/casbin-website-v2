---
id: rbac-with-domains
title: RBAC with Domains
description: Usage of RBAC with domains
keywords: [RBAC with domains]
authors: [hsluoyz]
---

## Role Definition with Domain Tenants

In Casbin, RBAC roles can be either global or domain-specific. Domain-specific roles allow a user to hold different roles across different domains or tenants. This capability is particularly valuable in large-scale systems such as cloud platforms, where users frequently operate within multiple distinct tenants.

The role definition for domains or tenants should be structured as follows:

```ini
[role_definition]
g = _, _, _
```

The third underscore `_` denotes the domain or tenant name and must remain unchanged. With this setup, policies can be written like this:

```csv
p, admin, tenant1, data1, read
p, admin, tenant2, data2, read

g, alice, admin, tenant1
g, alice, user, tenant2
```

This configuration means that the `admin` role in `tenant1` has read access to `data1`. Alice holds the `admin` role in `tenant1` and the `user` role in `tenant2`, so she can read `data1`. However, because Alice is not an `admin` in `tenant2`, she cannot read `data2`.

In your matcher, verify the role as follows:

```ini
[matchers]
m = g(r.sub, p.sub, r.dom) && r.dom == p.dom && r.obj == p.obj && r.act == p.act
```

For additional examples, refer to [rbac_with_domains_model.conf](https://github.com/casbin/casbin/blob/master/examples/rbac_with_domains_model.conf).

## Custom Domain Parameter Names

The domain parameter is conventionally named `dom` and placed as the second token (e.g., `sub, dom, obj, act`). However, you can use any name that suits your application—`tenant`, `organization`, `domain1`, or any other identifier.

When using custom domain names in matchers with domain-aware functions like `keyMatch`, Casbin automatically detects the domain token from your model definition:

```ini
[request_definition]
r = sub, tenant, obj, act

[policy_definition]
p = sub, tenant, obj, act

[role_definition]
g = _, _, _

[matchers]
m = g(r.sub, p.sub, r.tenant) && keyMatch(r.tenant, p.tenant) && r.obj == p.obj && r.act == p.act
```

This works seamlessly—enforcement will correctly match policies using your custom domain parameter name.

For domain-related API methods like `GetAllUsersByDomain()`, you need to inform Casbin about the domain token's position when using non-standard names or positions:

```ini
# Domain parameter in a different position
[policy_definition]
p = sub, obj, act, organization
```

```go
e.SetFieldIndex("p", constant.DomainIndex, 3) // index starts from 0
users := e.GetAllUsersByDomain("domain1")
```
