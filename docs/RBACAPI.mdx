---
id: rbac-api
title: RBAC API
description: A more friendly API for RBAC. This API is a subset of Management API. The RBAC users could use this API to simplify the code
keywords: [RBAC, API]
authors: [nodece]
---

A more friendly API for RBAC. This API is a subset of Management API. The RBAC users could use this API to simplify the code.

## Reference

global variable `e` is Enforcer instance.

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
e, err := NewEnforcer("examples/rbac_model.conf", "examples/rbac_policy.csv")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
const e = await newEnforcer('examples/rbac_model.conf', 'examples/rbac_policy.csv')
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$e = new Enforcer('examples/rbac_model.conf', 'examples/rbac_policy.csv');
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
e = casbin.Enforcer("examples/rbac_model.conf", "examples/rbac_policy.csv")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var e = new Enforcer("path/to/model.conf", "path/to/policy.csv");
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let mut e = Enforcer::new("examples/rbac_model.conf", "examples/rbac_policy.csv").await?;
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
Enforcer e = new Enforcer("examples/rbac_model.conf", "examples/rbac_policy.csv");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `GetRolesForUser()`

GetRolesForUser gets the roles that a user has.

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
res := e.GetRolesForUser("alice")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
const res = await e.getRolesForUser('alice')
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$res = $e->getRolesForUser("alice");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
roles = e.get_roles_for_user("alice")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var res = e.GetRolesForUser("alice");
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let roles = e.get_roles_for_user("alice", None); // No domain
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
List<String> res = e.getRolesForUser("alice");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `GetUsersForRole()`

GetUsersForRole gets the users that has a role.

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
res := e.GetUsersForRole("data1_admin")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
const res = await e.getUsersForRole('data1_admin')
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$res = $e->getUsersForRole("data1_admin");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
users = e.get_users_for_role("data1_admin")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var res = e.GetUsersForRole("data1_admin");
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let users = e.get_users_for_role("data1_admin", None); // No domain
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
List<String> res = e.getUsersForRole("data1_admin");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `HasRoleForUser()`

HasRoleForUser determines whether a user has a role.

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
res := e.HasRoleForUser("alice", "data1_admin")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
const res = await e.hasRoleForUser('alice', 'data1_admin')
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$res = $e->hasRoleForUser("alice", "data1_admin");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
has = e.has_role_for_user("alice", "data1_admin")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var res = e.HasRoleForUser("alice", "data1_admin");
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let has = e.has_role_for_user("alice", "data1_admin", None); // No domain
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
boolean res = e.hasRoleForUser("alice", "data1_admin");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `AddRoleForUser()`

AddRoleForUser adds a role for a user.
Returns false if the user already has the role (aka not affected).

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
e.AddRoleForUser("alice", "data2_admin")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
await e.addRoleForUser('alice', 'data2_admin')
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```PHP
$e->addRoleForUser("alice", "data2_admin");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
e.add_role_for_user("alice", "data2_admin")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var added = e.AddRoleForUser("alice", "data2_admin");
or
var added = await e.AddRoleForUserAsync("alice", "data2_admin");
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let added = e.add_role_for_user("alice", "data2_admin", None).await?; // No domain
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
boolean added = e.addRoleForUser("alice", "data2_admin");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `AddRolesForUser()`

AddRolesForUser adds multiple roles for a user.
Returns false if the user already has one of these roles (aka not affected).

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
var roles = []string{"data2_admin", "data1_admin"}
e.AddRolesForUser("alice", roles)
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
const roles = ["data1_admin", "data2_admin"];
roles.map((role) => e.addRoleForUser("alice", role));
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var roles = new List<string> { "data1_admin", "data2_admin" };
var allAdded = e.AddRolesForUser("alice", roles);
or
var allAdded = await e.AddRolesForUserAsync("alice", roles);
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let roles = vec!["data1_admin".to_owned(), "data2_admin".to_owned()];
let all_added = e.add_roles_for_user("alice", roles, None).await?; // No domain
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `DeleteRoleForUser()`

DeleteRoleForUser deletes a role for a user.
Returns false if the user does not have the role (aka not affected).

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
e.DeleteRoleForUser("alice", "data1_admin")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
await e.deleteRoleForUser('alice', 'data1_admin')
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$e->deleteRoleForUser("alice", "data1_admin");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
e.delete_role_for_user("alice", "data1_admin")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var deleted = e.DeleteRoleForUser("alice", "data1_admin");
or
var deleted = await e.DeleteRoleForUser("alice", "data1_admin");
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let deleted = e.delete_role_for_user("alice", "data1_admin", None).await?; // No domain
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
boolean deleted = e.deleteRoleForUser("alice", "data1_admin");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `DeleteRolesForUser()`

DeleteRolesForUser deletes all roles for a user.
Returns false if the user does not have any roles (aka not affected).

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
e.DeleteRolesForUser("alice")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
await e.deleteRolesForUser('alice')
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$e->deleteRolesForUser("alice");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
e.delete_roles_for_user("alice")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var deletedAtLeastOne = e.DeleteRolesForUser("alice");
or
var deletedAtLeastOne = await e.DeleteRolesForUserAsync("alice");
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let deleted_at_least_one = e.delete_roles_for_user("alice", None).await?; // No domain
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
boolean deletedAtLeastOne = e.deleteRolesForUser("alice");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `DeleteUser()`

DeleteUser deletes a user.
Returns false if the user does not exist (aka not affected).

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
e.DeleteUser("alice")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
await e.deleteUser('alice')
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$e->deleteUser("alice");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
e.delete_user("alice")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var deleted = e.DeleteUser("alice");
or
var deleted = await e.DeleteUserAsync("alice");
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let deleted = e.delete_user("alice").await?;
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
boolean deleted = e.deleteUser("alice");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `DeleteRole()`

DeleteRole deletes a role.

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
e.DeleteRole("data2_admin")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
await e.deleteRole("data2_admin")
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$e->deleteRole("data2_admin");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
e.delete_role("data2_admin")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var deleted = e.DeleteRole("data2_admin");
or
var deleted = await e.DeleteRoleAsync("data2_admin");
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let deleted = e.delete_role("data2_admin").await?;
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
e.deleteRole("data2_admin");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `DeletePermission()`

DeletePermission deletes a permission.
Returns false if the permission does not exist (aka not affected).

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
e.DeletePermission("read")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
await e.deletePermission('read')
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$e->deletePermission("read");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
e.delete_permission("read")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var deleted = e.DeletePermission("read");
or
var deleted = await e.DeletePermissionAsync("read");
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let deleted = e.delete_permission(vec!["read".to_owned()]).await?;
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
boolean deleted = e.deletePermission("read");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `AddPermissionForUser()`

AddPermissionForUser adds a permission for a user or role.
Returns false if the user or role already has the permission (aka not affected).

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
e.AddPermissionForUser("bob", "read")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
await e.addPermissionForUser('bob', 'read')
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$e->addPermissionForUser("bob", "read");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
e.add_permission_for_user("bob", "read")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var added = e.AddPermissionForUser("bob", "read");
or
var added = await e.AddPermissionForUserAsync("bob", "read");
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let added = e.add_permission_for_user("bob", vec!["read".to_owned()]).await?;
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
boolean added = e.addPermissionForUser("bob", "read");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `AddPermissionsForUser()`

AddPermissionsForUser adds multiple permissions for a user or role.
Returns false if the user or role already has one of the permissions (aka not affected).

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
var permissions = [][]string{{"data1", "read"},{"data2","write"}}
for i := 0; i < len(permissions); i++ {
    e.AddPermissionsForUser("alice", permissions[i])
}
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
const permissions = [
    ["data1", "read"],
    ["data2", "write"],
];

permissions.map((permission) => e.addPermissionForUser("bob", ...permission));
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var permissions = new List<List<string>>
{
    new List<string> { "data1", "read" },
    new List<string> { "data2", "write" }
};

foreach (var permission in permissions)
{
    var added = e.AddPermissionForUser("bob", permission.ToArray());
    or
    var added = await e.AddPermissionForUserAsync("bob", permission.ToArray());
}
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let permissions = vec![
    vec!["data1".to_owned(), "read".to_owned()],
    vec!["data2".to_owned(), "write".to_owned()],
];

let all_added = e.add_permissions_for_user("bob", permissions).await?;
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `DeletePermissionForUser()`

DeletePermissionForUser deletes a permission for a user or role.
Returns false if the user or role does not have the permission (aka not affected).

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
e.DeletePermissionForUser("bob", "read")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
await e.deletePermissionForUser("bob", "read")
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$e->deletePermissionForUser("bob", "read");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
e.delete_permission_for_user("bob", "read")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var deleted = e.DeletePermissionForUser("bob", "read");
or
var deleted = await e.DeletePermissionForUserAsync("bob", "read");
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let deleted = e.delete_permission_for_user("bob", vec!["read".to_owned()]).await?;
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
boolean deleted = e.deletePermissionForUser("bob", "read");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `DeletePermissionsForUser()`

DeletePermissionsForUser deletes permissions for a user or role.
Returns false if the user or role does not have any permissions (aka not affected).

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
e.DeletePermissionsForUser("bob")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
await e.deletePermissionsForUser('bob')
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$e->deletePermissionsForUser("bob");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
e.delete_permissions_for_user("bob")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var deletedAtLeastOne = e.DeletePermissionsForUser("bob");
or
var deletedAtLeastOne = await e.DeletePermissionsForUserAsync("bob");
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let deleted_at_least_one = e.delete_permissions_for_user("bob").await?;
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
boolean deletedAtLeastOne = e.deletePermissionForUser("bob");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `GetPermissionsForUser()`

GetPermissionsForUser gets permissions for a user or role.

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
e.GetPermissionsForUser("bob")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
await e.getPermissionsForUser('bob')
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$e->getPermissionsForUser("bob");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
e.get_permissions_for_user("bob")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var permissions = e.GetPermissionsForUser("bob");
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
List<List<String>> permissions = e.getPermissionsForUser("bob");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `GetNamedPermissionsForUser()`

GetNamedPermissionsForUser gets permissions for a user or role by named policy.

For example:

```csv
p, alice, data1, read
p, bob, data2, write
p2, admin, create
g, alice, admin
```

GetNamedPermissionsForUser("p", "alice") will return `[["alice", "data1", "read"]]`.
GetNamedPermissionsForUser("p2", "alice") will return `[["admin", "create"]]`.

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
permissions, err := e.GetNamedPermissionsForUser("p", "alice")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var permissions = e.GetNamedPermissionsForUser("p", "alice");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
permissions = e.get_named_permissions_for_user("p", "alice")
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `HasPermissionForUser()`

HasPermissionForUser determines whether a user has a permission.

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
e.HasPermissionForUser("alice", []string{"read"})
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
await e.hasPermissionForUser('alice', 'read')
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$e->hasPermissionForUser("alice", []string{"read"});
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
has = e.has_permission_for_user("alice", "read")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var has = e.HasPermissionForUser("bob", "read");
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let has = e.has_permission_for_user("alice", vec!["data1".to_owned(), "read".to_owned()]);
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
boolean has = e.hasPermissionForUser("alice", "read");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `GetImplicitRolesForUser()`

GetImplicitRolesForUser gets implicit roles that a user has.
Compared to GetRolesForUser(), this function retrieves indirect roles besides direct roles.

For example:

```csv
g, alice, role:admin  
g, role:admin, role:user  
```

GetRolesForUser("alice") can only get: ["role:admin"].  
But GetImplicitRolesForUser("alice") will get: ["role:admin", "role:user"].

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
e.GetImplicitRolesForUser("alice")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
await e.getImplicitRolesForUser("alice")
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$e->getImplicitRolesForUser("alice");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
e.get_implicit_roles_for_user("alice")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var implicitRoles = e.GetImplicitRolesForUser("alice");
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
e.get_implicit_roles_for_user("alice", None); // No domain
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
List<String> implicitRoles = e.getImplicitRolesForUser("alice");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `GetNamedImplicitRolesForUser()`

GetNamedImplicitRolesForUser gets implicit roles that a user has by named policy.

For example:

```csv
g, alice, admin
g, admin, super_admin
g2, alice, user
g2, user, guest
```

GetNamedImplicitRolesForUser("g", "alice") will return `["admin", "super_admin"]`.
GetNamedImplicitRolesForUser("g2", "alice") will return `["user", "guest"]`.

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
roles, err := e.GetNamedImplicitRolesForUser("g", "alice")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var roles = e.GetNamedImplicitRolesForUser("g", "alice");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
roles = e.get_named_implicit_roles_for_user("g", "alice")
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `GetImplicitUsersForRole()`

GetImplicitUsersForRole gets all users inheriting the role.
Compared to GetUsersForRole(), this function retrieves indirect users.

For example:  

```csv
g, alice, role:admin  
g, role:admin, role:user  
```

GetUsersForRole("role:user") can only get: ["role:admin"].  
But GetImplicitUesrsForRole("role:user") will get: ["role:admin", "alice"].

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
users := e.GetImplicitUsersForRole("role:user")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
const users = e.getImplicitUsersForRole("role:user");
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
List<String> users = e.getImplicitUsersForRole("role:user");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `GetImplicitPermissionsForUser()`

GetImplicitPermissionsForUser gets implicit permissions for a user or role.  
Compared to GetPermissionsForUser(), this function retrieves permissions for inherited roles.  

For example:  

```csv
p, admin, data1, read  
p, alice, data2, read  
g, alice, admin 
```

GetPermissionsForUser("alice") can only get: [["alice", "data2", "read"]].  
But GetImplicitPermissionsForUser("alice") will get: [["admin", "data1", "read"], ["alice", "data2", "read"]].

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
e.GetImplicitPermissionsForUser("alice")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```text
await e.getImplicitPermissionsForUser("alice")
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$e->getImplicitPermissionsForUser("alice");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
e.get_implicit_permissions_for_user("alice")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var implicitPermissions = e.GetImplicitPermissionsForUser("alice");
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
e.get_implicit_permissions_for_user("alice", None); // No domain
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
List<List<String>> implicitPermissions = e.getImplicitPermissionsForUser("alice");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `GetNamedImplicitPermissionsForUser()`

GetNamedImplicitPermissionsForUser gets implicit permissions for a user or role by named policy
Compared to GetImplicitPermissionsForUser(), this function allow you to specify the policy name.

For example:

```csv
p, admin, data1, read
p2, admin, create
g, alice, admin
```

GetImplicitPermissionsForUser("alice") only get: [["admin", "data1", "read"]], whose policy is default "p"

But you can specify the policy as "p2" to get: [["admin", "create"]] by GetNamedImplicitPermissionsForUser("p2","alice")

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
e.GetNamedImplicitPermissionsForUser("p2","alice")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var permissions = e.GetNamedImplicitPermissionsForUser("p2", "alice");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
e.get_named_implicit_permissions_for_user("p2", "alice")
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `GetDomainsForUser()`

GetDomainsForUser gets all domains which a user has.

For example:

```csv
p, admin, domain1, data1, read
p, admin, domain2, data2, read
p, admin, domain2, data2, write
g, alice, admin, domain1
g, alice, admin, domain2
```

GetDomainsForUser("alice") could get ["domain1", "domain2"]

For example:

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
result, err := e.GetDomainsForUser("alice")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var result = e.GetDomainsForUser("alice");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `GetImplicitResourcesForUser()`

GetImplicitResourcesForUser returns all policies that should be true for user.

For example:

```csv
p, alice, data1, read
p, bob, data2, write
p, data2_admin, data2, read
p, data2_admin, data2, write

g, alice, data2_admin
```

GetImplicitResourcesForUser("alice") will return
`[[alice data1 read] [alice data2 read] [alice data2 write]]`

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
resources, err := e.GetImplicitResourcesForUser("alice")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var resources = e.GetImplicitResourcesForUser("alice");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `GetImplicitUsersForPermission()`

GetImplicitUsersForPermission gets implicit users for a permission.

For example:

```csv
p, admin, data1, read
p, bob, data1, read
g, alice, admin
```

GetImplicitUsersForPermission("data1", "read") will return: `["alice", "bob"]`.

Note: only users will be returned, roles (2nd arg in "g") will be excluded.

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
users, err := e.GetImplicitUsersForPermission("data1", "read")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var users = e.GetImplicitUsersForPermission("data1", "read");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `GetImplicitObjectPatternsForUser()`

GetImplicitObjectPatternsForUser returns all object patterns (with wildcards) that a user has for a given domain and action.

For example:

```csv
p, admin, chronicle/123, location/*, read
p, user, chronicle/456, location/789, read
g, alice, admin
g, bob, user
```

GetImplicitObjectPatternsForUser("alice", "chronicle/123", "read") will return `["location/*"]`.
GetImplicitObjectPatternsForUser("bob", "chronicle/456", "read") will return `["location/789"]`.

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
patterns, err := e.GetImplicitObjectPatternsForUser("alice", "chronicle/123", "read")
```

```mdx-code-block
</TabItem>
<TabItem value="Node.js" label="Node.js">
```

```typescript
const patterns = await e.getImplicitObjectPatternsForUser("alice", "chronicle/123", "read")
```

```mdx-code-block
</TabItem>
<TabItem value="PHP" label="PHP">
```

```php
$patterns = $e->getImplicitObjectPatternsForUser("alice", "chronicle/123", "read");
```

```mdx-code-block
</TabItem>
<TabItem value="Python" label="Python">
```

```python
patterns = e.get_implicit_object_patterns_for_user("alice", "chronicle/123", "read")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var patterns = e.GetImplicitObjectPatternsForUser("alice", "chronicle/123", "read");
```

```mdx-code-block
</TabItem>
<TabItem value="Rust" label="Rust">
```

```rust
let patterns = e.get_implicit_object_patterns_for_user("alice", "chronicle/123", "read").await?;
```

```mdx-code-block
</TabItem>
<TabItem value="Java" label="Java">
```

```java
List<String> patterns = e.getImplicitObjectPatternsForUser("alice", "chronicle/123", "read");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `GetAllowedObjectConditions()`

GetAllowedObjectConditions returns a string array of object conditions that the user can access.

For example:

```csv
p, alice, r.obj.price < 25, read
p, admin, r.obj.category_id = 2, read
p, bob, r.obj.author = bob, write

g, alice, admin
```

e.GetAllowedObjectConditions("alice", "read", "r.obj.") will return `["price < 25", "category_id = 2"], nil`

Note:

0. prefix: You can customize the prefix of the object conditions, and "r.obj." is commonly used as a prefix.
After removing the prefix, the remaining part is the condition of the object.
If there is an obj policy that does not meet the prefix requirement, an `errors.ERR_OBJ_CONDITION` will be returned.

1. If the 'objectConditions' array is empty, return `errors.ERR_EMPTY_CONDITION`
This error is returned because some data adapters' ORM return full table data by default
when they receive an empty condition, which tends to behave contrary to expectations.(e.g. GORM)
If you are using an adapter that does not behave like this, you can choose to ignore this error.

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
conditions, err := e.GetAllowedObjectConditions("alice", "read", "r.obj.")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var conditions = e.GetAllowedObjectConditions("alice", "read", "r.obj.");
```

```mdx-code-block
</TabItem>
</Tabs>
```

### `GetImplicitUsersForResource()`

GetImplicitUsersForResource return implicit user based on resource.

For example:

```csv
p, alice, data1, read
p, bob, data2, write
p, data2_admin, data2, read
p, data2_admin, data2, write
g, alice, data2_admin
```

GetImplicitUsersForResource("data2") will return `[["bob", "data2", "write"], ["alice", "data2", "read"] ["alice", "data2", "write"]], nil`.

GetImplicitUsersForResource("data1") will return `[["alice", "data1", "read"]], nil`.

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
ImplicitUsers, err := e.GetImplicitUsersForResource("data2")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var implicitUsers = e.GetImplicitUsersForResource("data2");
```

```mdx-code-block
</TabItem>
</Tabs>
```

:::note

Only users will be returned, roles (2nd arg in "g") will be excluded.

:::

### `GetNamedImplicitUsersForResource()`

GetNamedImplicitUsersForResource return implicit user based on resource with named policy support.
This function handles resource role relationships through named policies (e.g., g2, g3, etc.).

For example:

```csv
p, admin_group, admin_data, *
g, admin, admin_group
g2, app, admin_data
```

GetNamedImplicitUsersForResource("g2", "app") will return users who have access to admin_data through g2 relationship.

```mdx-code-block
<Tabs groupId="langs">
<TabItem value="Go" label="Go" default>
```

```go
ImplicitUsers, err := e.GetNamedImplicitUsersForResource("g2", "app")
```

```mdx-code-block
</TabItem>
<TabItem value=".NET" label=".NET">
```

```csharp
var implicitUsers = e.GetNamedImplicitUsersForResource("g2", "app");
```

```mdx-code-block
</TabItem>
</Tabs>
```
